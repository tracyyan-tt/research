/*! For license information please see wslink.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.wslink=t():e.wslink=t()}(self,(()=>(()=>{"use strict";var e={d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};function n(e){return e.charAt(0).toUpperCase()+e.slice(1)}e.r(t),e.d(t,{CompositeClosureHelper:()=>r,ProcessLauncher:()=>a,SmartConnect:()=>_e,WebsocketConnection:()=>Oe});const r={chain:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.filter((function(e){return!!e})).forEach((function(e){return e.apply(void 0,n)}))}},destroy:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.destroy;t.subscriptions||(t.subscriptions=[]),e.destroy=function(){for(n&&n();t.subscriptions&&t.subscriptions.length;)t.subscriptions.pop().unsubscribe();Object.keys(t).forEach((function(e){delete t[e]})),t.deleted=!0}},event:function(e,t,r){var o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=[],s=e.destroy;function c(e){i[e]=null}e["fire".concat(n(r))]=function(){for(var n=arguments.length,s=new Array(n),c=0;c<n;c++)s[c]=arguments[c];function a(){i.forEach((function(t){if(t)try{t.apply(e,s)}catch(e){console.log("Error event:",r,e)}}))}t.deleted?console.log("instance deleted - can not call any method"):o?setTimeout(a,0):a()},e["on".concat(n(r))]=function(e){if(t.deleted)return console.log("instance deleted - can not call any method"),null;var n=i.length;return i.push(e),function(e){return Object.freeze({unsubscribe:function(){c(e)}})}(n)},e.destroy=function(){s(),i.forEach((function(e,t){return c(t)}))}},get:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(arguments.length>2&&void 0!==arguments[2]?arguments[2]:[]).forEach((function(r){e["get".concat(n(r))]=function(){return t[r]}}))},isA:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;t.isA||(t.isA=[]),n&&t.isA.push(n),e.isA||(e.isA=function(e){return-1!==t.isA.indexOf(e)})},newInstance:function(e){return function(){var t={};return e(t,{},arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),Object.freeze(t)}},set:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(arguments.length>2&&void 0!==arguments[2]?arguments[2]:[]).forEach((function(r){e["set".concat(n(r))]=function(e){t[r]=e}}))}};function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var i=[],s={endPoint:null};function c(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,s,n),r.destroy(e,t),r.event(e,t,"ProcessReady"),r.event(e,t,"ProcessStopped"),r.event(e,t,"Fetch"),r.event(e,t,"Error"),r.isA(e,t,"ProcessLauncher"),function(e,t){var n=this;e.start=function(n){var r=new XMLHttpRequest,s=t.endPoint;r.open("POST",s,!0),n.headers&&(Object.entries(n.headers).forEach((function(e){var t,n,i=(n=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,s,c=[],a=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;a=!1}else for(;!(a=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);a=!0);}catch(e){u=!0,o=e}finally{try{if(!a&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(u)throw o}}return c}}(t,n)||function(e,t){if(e){if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),s=i[0],c=i[1];return r.setRequestHeader(s,c)})),delete n.headers),r.responseType="json";var c="response"in r&&"json"===r.responseType;r.onload=function(t){var n=c?r.response:JSON.parse(r.response);if(200===r.status&&n&&!n.error)return i.push(n),void e.fireProcessReady(n);e.fireError(r)},r.onerror=function(t){e.fireError(r)},r.send(JSON.stringify(n))},e.fetchConnection=function(r){var o=new XMLHttpRequest,i=[t.endPoint,r].join("/");o.open("GET",i,!0),o.responseType="json";var s="response"in o&&"json"===o.responseType;o.onload=function(t){200!==n.status?e.fireError(o):e.fireFetch(s?o.response:JSON.parse(o.response))},o.onerror=function(t){e.fireError(o)},o.send()},e.stop=function(r){var o=new XMLHttpRequest,i=[t.endPoint,r.id].join("/");o.open("DELETE",i,!0),o.responseType="json";var s="response"in o&&"json"===o.responseType;o.onload=function(t){if(200!==n.status)e.fireError(o);else{var r=s?o.response:JSON.parse(o.response);e.fireProcessStopped(r)}},o.onerror=function(t){e.fireError(o)},o.send()},e.listConnections=function(){return i}}(e,t)}const a={newInstance:r.newInstance(c),extend:c};function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function f(e,t,n,r,o,i,s){try{var c=e[i](s),a=c.value}catch(e){return void n(e)}c.done?t(a):Promise.resolve(a).then(r,o)}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function l(e){var t=function(e,t){if("object"!==u(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===u(t)?t:String(t)}function p(){p=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function a(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{a({},"")}catch(e){a=function(e,t,n){return e[t]=n}}function f(e,t,n,o){var i=t&&t.prototype instanceof d?t:d,s=Object.create(i.prototype),c=new O(o||[]);return r(s,"_invoke",{value:S(e,n,c)}),s}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=f;var l={};function d(){}function y(){}function v(){}var w={};a(w,i,(function(){return this}));var g=Object.getPrototypeOf,b=g&&g(g(k([])));b&&b!==t&&n.call(b,i)&&(w=b);var m=v.prototype=d.prototype=Object.create(w);function U(e){["next","throw","return"].forEach((function(t){a(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,t){function o(r,i,s,c){var a=h(e[r],e,i);if("throw"!==a.type){var f=a.arg,l=f.value;return l&&"object"==u(l)&&n.call(l,"__await")?t.resolve(l.__await).then((function(e){o("next",e,s,c)}),(function(e){o("throw",e,s,c)})):t.resolve(l).then((function(e){f.value=e,s(f)}),(function(e){return o("throw",e,s,c)}))}c(a.arg)}var i;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){o(e,n,t,r)}))}return i=i?i.then(r,r):r()}})}function S(e,t,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var s=n.delegate;if(s){var c=E(s,n);if(c){if(c===l)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var a=h(e,t,n);if("normal"===a.type){if(r=n.done?"completed":"suspendedYield",a.arg===l)continue;return{value:a.arg,done:n.done}}"throw"===a.type&&(r="completed",n.method="throw",n.arg=a.arg)}}}function E(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),l;var o=h(r,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,l;var i=o.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,l):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,l)}function L(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function j(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(L,this),this.reset(!0)}function k(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:A}}function A(){return{value:void 0,done:!0}}return y.prototype=v,r(m,"constructor",{value:v,configurable:!0}),r(v,"constructor",{value:y,configurable:!0}),y.displayName=a(v,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,a(e,c,"GeneratorFunction")),e.prototype=Object.create(m),e},e.awrap=function(e){return{__await:e}},U(x.prototype),a(x.prototype,s,(function(){return this})),e.AsyncIterator=x,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var s=new x(f(t,n,r,o),i);return e.isGeneratorFunction(n)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},U(m),a(m,c,"Generator"),a(m,i,(function(){return this})),a(m,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=k,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(j),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return s.type="throw",s.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],s=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),a=n.call(i,"finallyLoc");if(c&&a){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!a)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var s=i?i.completion:{};return s.type=e,s.arg=t,i?(this.method="next",this.next=i.finallyLoc,l):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),l},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),j(n),l}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;j(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:k(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},e}var d=p().mark(U),y=0,v=y+4,w=v+4,g=12;function b(e,t,n){var r=new ArrayBuffer(g),o=new Uint8Array(r),i=new DataView(r);return i.setUint32(y,e,!0),i.setUint32(v,t,!0),i.setUint32(w,n,!0),o}function m(e){var t=new DataView(e.buffer);return{id:t.getUint32(y,!0),offset:t.getUint32(v,!0),size:t.getUint32(w,!0)}}function U(e,t){var n,r,o,i,s,c,a;return p().wrap((function(u){for(;;)switch(u.prev=u.next){case 0:n=e.byteLength,r=0===t?n:Math.max(t-g,1),o=new Uint32Array(1),crypto.getRandomValues(o),i=0;case 5:if(!(i<n)){u.next=16;break}return s=Math.min(r,n-i),c=new Uint8Array(new ArrayBuffer(g+s)),a=b(o[0],i,n),c.set(new Uint8Array(a.buffer),0),c.set(e.subarray(i,i+s),g),u.next=13,c;case 13:i+=s,u.next=5;break;case 16:return u.abrupt("return");case 17:case"end":return u.stop()}}),d)}var x=function(){function e(){var t,n,r;(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),t=this,r=void 0,(n=l(n="pendingMessages"))in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,this.pendingMessages={}}var t,n,r,o,i;return n=e,r=[{key:"releasePendingMessages",value:function(){this.pendingMessages={}}},{key:"processChunk",value:(i=p().mark((function e(t,n){var r,o,i,s,c,a,u,f,h,l;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.slice(0,g),o=t.slice(g),e.t0=Uint8Array,e.next=5,r.arrayBuffer();case 5:if(e.t1=e.sent,i=new e.t0(e.t1),s=m(i),c=s.id,a=s.offset,u=s.size,(f=this.pendingMessages[c])||(f={receivedSize:0,content:new Uint8Array(u),decoder:n()},this.pendingMessages[c]=f),u===f.content.byteLength){e.next=13;break}throw delete this.pendingMessages[c],new Error("Total size in chunk header for message ".concat(c," does not match total size declared by previous chunk."));case 13:return e.t2=Uint8Array,e.next=16,o.arrayBuffer();case 16:if(e.t3=e.sent,h=new e.t2(e.t3),(l=f.content).set(h,a),f.receivedSize+=h.byteLength,!(f.receivedSize>=u)){e.next=30;break}return delete this.pendingMessages[c],e.prev=23,e.abrupt("return",f.decoder.decode(l));case 27:e.prev=27,e.t4=e.catch(23),console.error("Malformed message: ",l.slice(0,100));case 30:return e.abrupt("return",void 0);case 31:case"end":return e.stop()}}),e,this,[[23,27]])})),t=function(){var e=this,t=arguments;return new Promise((function(n,r){var o=i.apply(e,t);function s(e){f(o,n,r,s,c,"next",e)}function c(e){f(o,n,r,s,c,"throw",e)}s(void 0)}))},function(e,n){return t.apply(this,arguments)})}],r&&h(n.prototype,r),o&&h(n,o),Object.defineProperty(n,"prototype",{writable:!1}),e}();function S(e){return"".concat(e<0?"-":"","0x").concat(Math.abs(e).toString(16).padStart(2,"0"))}var E,L=function(e,t){this.type=e,this.data=t},j=(E=function(e,t){return E=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},E(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}E(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),O=function(e){function t(n){var r=e.call(this,n)||this,o=Object.create(t.prototype);return Object.setPrototypeOf(r,o),Object.defineProperty(r,"name",{configurable:!0,enumerable:!1,value:t.name}),r}return j(t,e),t}(Error),k=4294967295;function A(e,t,n){var r=Math.floor(n/4294967296),o=n;e.setUint32(t,r),e.setUint32(t+4,o)}function P(e,t){return 4294967296*e.getInt32(t)+e.getUint32(t+4)}var I,T,B,_={type:-1,encode:function(e){var t,n,r,o;return e instanceof Date?function(e){var t,n=e.sec,r=e.nsec;if(n>=0&&r>=0&&n<=17179869183){if(0===r&&n<=4294967295){var o=new Uint8Array(4);return(t=new DataView(o.buffer)).setUint32(0,n),o}var i=n/4294967296,s=4294967295&n;return o=new Uint8Array(8),(t=new DataView(o.buffer)).setUint32(0,r<<2|3&i),t.setUint32(4,s),o}return o=new Uint8Array(12),(t=new DataView(o.buffer)).setUint32(0,r),A(t,4,n),o}((r=1e6*((t=e.getTime())-1e3*(n=Math.floor(t/1e3))),{sec:n+(o=Math.floor(r/1e9)),nsec:r-1e9*o})):null},decode:function(e){var t=function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);switch(e.byteLength){case 4:return{sec:t.getUint32(0),nsec:0};case 8:var n=t.getUint32(0);return{sec:4294967296*(3&n)+t.getUint32(4),nsec:n>>>2};case 12:return{sec:P(t,4),nsec:t.getUint32(0)};default:throw new O("Unrecognized data size for timestamp (expected 4, 8, or 12): ".concat(e.length))}}(e);return new Date(1e3*t.sec+t.nsec/1e6)}},C=function(){function e(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(_)}return e.prototype.register=function(e){var t=e.type,n=e.encode,r=e.decode;if(t>=0)this.encoders[t]=n,this.decoders[t]=r;else{var o=1+t;this.builtInEncoders[o]=n,this.builtInDecoders[o]=r}},e.prototype.tryToEncode=function(e,t){for(var n=0;n<this.builtInEncoders.length;n++)if(null!=(r=this.builtInEncoders[n])&&null!=(o=r(e,t)))return new L(-1-n,o);for(n=0;n<this.encoders.length;n++){var r,o;if(null!=(r=this.encoders[n])&&null!=(o=r(e,t)))return new L(n,o)}return e instanceof L?e:null},e.prototype.decode=function(e,t,n){var r=t<0?this.builtInDecoders[-1-t]:this.decoders[t];return r?r(e,t,n):new L(t,e)},e.defaultCodec=new e,e}(),M=("undefined"==typeof process||"never"!==(null===(I=null===process||void 0===process?void 0:process.env)||void 0===I?void 0:I.TEXT_ENCODING))&&"undefined"!=typeof TextEncoder&&"undefined"!=typeof TextDecoder;function z(e){for(var t=e.length,n=0,r=0;r<t;){var o=e.charCodeAt(r++);if(0!=(4294967168&o))if(0==(4294965248&o))n+=2;else{if(o>=55296&&o<=56319&&r<t){var i=e.charCodeAt(r);56320==(64512&i)&&(++r,o=((1023&o)<<10)+(1023&i)+65536)}n+=0==(4294901760&o)?3:4}else n++}return n}var R=M?new TextEncoder:void 0,D=M?"undefined"!=typeof process&&"force"!==(null===(T=null===process||void 0===process?void 0:process.env)||void 0===T?void 0:T.TEXT_ENCODING)?200:0:k,F=(null==R?void 0:R.encodeInto)?function(e,t,n){R.encodeInto(e,t.subarray(n))}:function(e,t,n){t.set(R.encode(e),n)},N=4096;function W(e,t,n){for(var r=t,o=r+n,i=[],s="";r<o;){var c=e[r++];if(0==(128&c))i.push(c);else if(192==(224&c)){var a=63&e[r++];i.push((31&c)<<6|a)}else if(224==(240&c)){a=63&e[r++];var u=63&e[r++];i.push((31&c)<<12|a<<6|u)}else if(240==(248&c)){var f=(7&c)<<18|(a=63&e[r++])<<12|(u=63&e[r++])<<6|63&e[r++];f>65535&&(f-=65536,i.push(f>>>10&1023|55296),f=56320|1023&f),i.push(f)}else i.push(c);i.length>=N&&(s+=String.fromCharCode.apply(String,i),i.length=0)}return i.length>0&&(s+=String.fromCharCode.apply(String,i)),s}var G=M?new TextDecoder:null,V=M?"undefined"!=typeof process&&"force"!==(null===(B=null===process||void 0===process?void 0:process.env)||void 0===B?void 0:B.TEXT_DECODER)?200:0:k;function H(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer?new Uint8Array(e):Uint8Array.from(e)}var K=16,X=16,q=function(){function e(e,t){void 0===e&&(e=K),void 0===t&&(t=X),this.maxKeyLength=e,this.maxLengthPerKey=t,this.hit=0,this.miss=0,this.caches=[];for(var n=0;n<this.maxKeyLength;n++)this.caches.push([])}return e.prototype.canBeCached=function(e){return e>0&&e<=this.maxKeyLength},e.prototype.find=function(e,t,n){e:for(var r=0,o=this.caches[n-1];r<o.length;r++){for(var i=o[r],s=i.bytes,c=0;c<n;c++)if(s[c]!==e[t+c])continue e;return i.str}return null},e.prototype.store=function(e,t){var n=this.caches[e.length-1],r={bytes:e,str:t};n.length>=this.maxLengthPerKey?n[Math.random()*n.length|0]=r:n.push(r)},e.prototype.decode=function(e,t,n){var r=this.find(e,t,n);if(null!=r)return this.hit++,r;this.miss++;var o=W(e,t,n),i=Uint8Array.prototype.slice.call(e,t,t+n);return this.store(i,o),o},e}(),J=function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}},Y=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,o){!function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)}(r,o,(t=e[n](t)).done,t.value)}))}}},$=function(e){return this instanceof $?(this.v=e,this):new $(e)},Q=function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,o=n.apply(e,t||[]),i=[];return r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r;function s(e){o[e]&&(r[e]=function(t){return new Promise((function(n,r){i.push([e,t,n,r])>1||c(e,t)}))})}function c(e,t){try{(n=o[e](t)).value instanceof $?Promise.resolve(n.value.v).then(a,u):f(i[0][2],n)}catch(e){f(i[0][3],e)}var n}function a(e){c("next",e)}function u(e){c("throw",e)}function f(e,t){e(t),i.shift(),i.length&&c(i[0][0],i[0][1])}},Z=-1,ee=new DataView(new ArrayBuffer(0)),te=new Uint8Array(ee.buffer),ne=function(){try{ee.getInt8(0)}catch(e){return e.constructor}throw new Error("never reached")}(),re=new ne("Insufficient data"),oe=new q,ie=function(){function e(e,t,n,r,o,i,s,c){void 0===e&&(e=C.defaultCodec),void 0===t&&(t=void 0),void 0===n&&(n=k),void 0===r&&(r=k),void 0===o&&(o=k),void 0===i&&(i=k),void 0===s&&(s=k),void 0===c&&(c=oe),this.extensionCodec=e,this.context=t,this.maxStrLength=n,this.maxBinLength=r,this.maxArrayLength=o,this.maxMapLength=i,this.maxExtLength=s,this.keyDecoder=c,this.totalPos=0,this.pos=0,this.view=ee,this.bytes=te,this.headByte=Z,this.stack=[]}return e.prototype.reinitializeState=function(){this.totalPos=0,this.headByte=Z,this.stack.length=0},e.prototype.setBuffer=function(e){this.bytes=H(e),this.view=function(e){if(e instanceof ArrayBuffer)return new DataView(e);var t=H(e);return new DataView(t.buffer,t.byteOffset,t.byteLength)}(this.bytes),this.pos=0},e.prototype.appendBuffer=function(e){if(this.headByte!==Z||this.hasRemaining(1)){var t=this.bytes.subarray(this.pos),n=H(e),r=new Uint8Array(t.length+n.length);r.set(t),r.set(n,t.length),this.setBuffer(r)}else this.setBuffer(e)},e.prototype.hasRemaining=function(e){return this.view.byteLength-this.pos>=e},e.prototype.createExtraByteError=function(e){var t=this.view,n=this.pos;return new RangeError("Extra ".concat(t.byteLength-n," of ").concat(t.byteLength," byte(s) found at buffer[").concat(e,"]"))},e.prototype.decode=function(e){this.reinitializeState(),this.setBuffer(e);var t=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return t},e.prototype.decodeMulti=function(e){return J(this,(function(t){switch(t.label){case 0:this.reinitializeState(),this.setBuffer(e),t.label=1;case 1:return this.hasRemaining(1)?[4,this.doDecodeSync()]:[3,3];case 2:return t.sent(),[3,1];case 3:return[2]}}))},e.prototype.decodeAsync=function(e){var t,n,r,o,i,s,c,a;return i=this,s=void 0,a=function(){var i,s,c,a,u,f,h,l;return J(this,(function(p){switch(p.label){case 0:i=!1,p.label=1;case 1:p.trys.push([1,6,7,12]),t=Y(e),p.label=2;case 2:return[4,t.next()];case 3:if((n=p.sent()).done)return[3,5];if(c=n.value,i)throw this.createExtraByteError(this.totalPos);this.appendBuffer(c);try{s=this.doDecodeSync(),i=!0}catch(e){if(!(e instanceof ne))throw e}this.totalPos+=this.pos,p.label=4;case 4:return[3,2];case 5:return[3,12];case 6:return a=p.sent(),r={error:a},[3,12];case 7:return p.trys.push([7,,10,11]),n&&!n.done&&(o=t.return)?[4,o.call(t)]:[3,9];case 8:p.sent(),p.label=9;case 9:return[3,11];case 10:if(r)throw r.error;return[7];case 11:return[7];case 12:if(i){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return[2,s]}throw f=(u=this).headByte,h=u.pos,l=u.totalPos,new RangeError("Insufficient data in parsing ".concat(S(f)," at ").concat(l," (").concat(h," in the current buffer)"))}}))},new((c=void 0)||(c=Promise))((function(e,t){function n(e){try{o(a.next(e))}catch(e){t(e)}}function r(e){try{o(a.throw(e))}catch(e){t(e)}}function o(t){var o;t.done?e(t.value):(o=t.value,o instanceof c?o:new c((function(e){e(o)}))).then(n,r)}o((a=a.apply(i,s||[])).next())}))},e.prototype.decodeArrayStream=function(e){return this.decodeMultiAsync(e,!0)},e.prototype.decodeStream=function(e){return this.decodeMultiAsync(e,!1)},e.prototype.decodeMultiAsync=function(e,t){return Q(this,arguments,(function(){var n,r,o,i,s,c,a,u,f;return J(this,(function(h){switch(h.label){case 0:n=t,r=-1,h.label=1;case 1:h.trys.push([1,13,14,19]),o=Y(e),h.label=2;case 2:return[4,$(o.next())];case 3:if((i=h.sent()).done)return[3,12];if(s=i.value,t&&0===r)throw this.createExtraByteError(this.totalPos);this.appendBuffer(s),n&&(r=this.readArraySize(),n=!1,this.complete()),h.label=4;case 4:h.trys.push([4,9,,10]),h.label=5;case 5:return[4,$(this.doDecodeSync())];case 6:return[4,h.sent()];case 7:return h.sent(),0==--r?[3,8]:[3,5];case 8:return[3,10];case 9:if(!((c=h.sent())instanceof ne))throw c;return[3,10];case 10:this.totalPos+=this.pos,h.label=11;case 11:return[3,2];case 12:return[3,19];case 13:return a=h.sent(),u={error:a},[3,19];case 14:return h.trys.push([14,,17,18]),i&&!i.done&&(f=o.return)?[4,$(f.call(o))]:[3,16];case 15:h.sent(),h.label=16;case 16:return[3,18];case 17:if(u)throw u.error;return[7];case 18:return[7];case 19:return[2]}}))}))},e.prototype.doDecodeSync=function(){e:for(;;){var e=this.readHeadByte(),t=void 0;if(e>=224)t=e-256;else if(e<192)if(e<128)t=e;else if(e<144){if(0!=(r=e-128)){this.pushMapState(r),this.complete();continue e}t={}}else if(e<160){if(0!=(r=e-144)){this.pushArrayState(r),this.complete();continue e}t=[]}else{var n=e-160;t=this.decodeUtf8String(n,0)}else if(192===e)t=null;else if(194===e)t=!1;else if(195===e)t=!0;else if(202===e)t=this.readF32();else if(203===e)t=this.readF64();else if(204===e)t=this.readU8();else if(205===e)t=this.readU16();else if(206===e)t=this.readU32();else if(207===e)t=this.readU64();else if(208===e)t=this.readI8();else if(209===e)t=this.readI16();else if(210===e)t=this.readI32();else if(211===e)t=this.readI64();else if(217===e)n=this.lookU8(),t=this.decodeUtf8String(n,1);else if(218===e)n=this.lookU16(),t=this.decodeUtf8String(n,2);else if(219===e)n=this.lookU32(),t=this.decodeUtf8String(n,4);else if(220===e){if(0!==(r=this.readU16())){this.pushArrayState(r),this.complete();continue e}t=[]}else if(221===e){if(0!==(r=this.readU32())){this.pushArrayState(r),this.complete();continue e}t=[]}else if(222===e){if(0!==(r=this.readU16())){this.pushMapState(r),this.complete();continue e}t={}}else if(223===e){if(0!==(r=this.readU32())){this.pushMapState(r),this.complete();continue e}t={}}else if(196===e){var r=this.lookU8();t=this.decodeBinary(r,1)}else if(197===e)r=this.lookU16(),t=this.decodeBinary(r,2);else if(198===e)r=this.lookU32(),t=this.decodeBinary(r,4);else if(212===e)t=this.decodeExtension(1,0);else if(213===e)t=this.decodeExtension(2,0);else if(214===e)t=this.decodeExtension(4,0);else if(215===e)t=this.decodeExtension(8,0);else if(216===e)t=this.decodeExtension(16,0);else if(199===e)r=this.lookU8(),t=this.decodeExtension(r,1);else if(200===e)r=this.lookU16(),t=this.decodeExtension(r,2);else{if(201!==e)throw new O("Unrecognized type byte: ".concat(S(e)));r=this.lookU32(),t=this.decodeExtension(r,4)}this.complete();for(var o=this.stack;o.length>0;){var i=o[o.length-1];if(0===i.type){if(i.array[i.position]=t,i.position++,i.position!==i.size)continue e;o.pop(),t=i.array}else{if(1===i.type){if(void 0,"string"!=(s=typeof t)&&"number"!==s)throw new O("The type of key must be string or number but "+typeof t);if("__proto__"===t)throw new O("The key __proto__ is not allowed");i.key=t,i.type=2;continue e}if(i.map[i.key]=t,i.readCount++,i.readCount!==i.size){i.key=null,i.type=1;continue e}o.pop(),t=i.map}}return t}var s},e.prototype.readHeadByte=function(){return this.headByte===Z&&(this.headByte=this.readU8()),this.headByte},e.prototype.complete=function(){this.headByte=Z},e.prototype.readArraySize=function(){var e=this.readHeadByte();switch(e){case 220:return this.readU16();case 221:return this.readU32();default:if(e<160)return e-144;throw new O("Unrecognized array type byte: ".concat(S(e)))}},e.prototype.pushMapState=function(e){if(e>this.maxMapLength)throw new O("Max length exceeded: map length (".concat(e,") > maxMapLengthLength (").concat(this.maxMapLength,")"));this.stack.push({type:1,size:e,key:null,readCount:0,map:{}})},e.prototype.pushArrayState=function(e){if(e>this.maxArrayLength)throw new O("Max length exceeded: array length (".concat(e,") > maxArrayLength (").concat(this.maxArrayLength,")"));this.stack.push({type:0,size:e,array:new Array(e),position:0})},e.prototype.decodeUtf8String=function(e,t){var n;if(e>this.maxStrLength)throw new O("Max length exceeded: UTF-8 byte length (".concat(e,") > maxStrLength (").concat(this.maxStrLength,")"));if(this.bytes.byteLength<this.pos+t+e)throw re;var r,o=this.pos+t;return r=this.stateIsMapKey()&&(null===(n=this.keyDecoder)||void 0===n?void 0:n.canBeCached(e))?this.keyDecoder.decode(this.bytes,o,e):e>V?function(e,t,n){var r=e.subarray(t,t+n);return G.decode(r)}(this.bytes,o,e):W(this.bytes,o,e),this.pos+=t+e,r},e.prototype.stateIsMapKey=function(){return this.stack.length>0&&1===this.stack[this.stack.length-1].type},e.prototype.decodeBinary=function(e,t){if(e>this.maxBinLength)throw new O("Max length exceeded: bin length (".concat(e,") > maxBinLength (").concat(this.maxBinLength,")"));if(!this.hasRemaining(e+t))throw re;var n=this.pos+t,r=this.bytes.subarray(n,n+e);return this.pos+=t+e,r},e.prototype.decodeExtension=function(e,t){if(e>this.maxExtLength)throw new O("Max length exceeded: ext length (".concat(e,") > maxExtLength (").concat(this.maxExtLength,")"));var n=this.view.getInt8(this.pos+t),r=this.decodeBinary(e,t+1);return this.extensionCodec.decode(r,n,this.context)},e.prototype.lookU8=function(){return this.view.getUint8(this.pos)},e.prototype.lookU16=function(){return this.view.getUint16(this.pos)},e.prototype.lookU32=function(){return this.view.getUint32(this.pos)},e.prototype.readU8=function(){var e=this.view.getUint8(this.pos);return this.pos++,e},e.prototype.readI8=function(){var e=this.view.getInt8(this.pos);return this.pos++,e},e.prototype.readU16=function(){var e=this.view.getUint16(this.pos);return this.pos+=2,e},e.prototype.readI16=function(){var e=this.view.getInt16(this.pos);return this.pos+=2,e},e.prototype.readU32=function(){var e=this.view.getUint32(this.pos);return this.pos+=4,e},e.prototype.readI32=function(){var e=this.view.getInt32(this.pos);return this.pos+=4,e},e.prototype.readU64=function(){var e,t,n=(e=this.view,t=this.pos,4294967296*e.getUint32(t)+e.getUint32(t+4));return this.pos+=8,n},e.prototype.readI64=function(){var e=P(this.view,this.pos);return this.pos+=8,e},e.prototype.readF32=function(){var e=this.view.getFloat32(this.pos);return this.pos+=4,e},e.prototype.readF64=function(){var e=this.view.getFloat64(this.pos);return this.pos+=8,e},e}(),se=100,ce=2048,ae=function(){function e(e,t,n,r,o,i,s,c){void 0===e&&(e=C.defaultCodec),void 0===t&&(t=void 0),void 0===n&&(n=se),void 0===r&&(r=ce),void 0===o&&(o=!1),void 0===i&&(i=!1),void 0===s&&(s=!1),void 0===c&&(c=!1),this.extensionCodec=e,this.context=t,this.maxDepth=n,this.initialBufferSize=r,this.sortKeys=o,this.forceFloat32=i,this.ignoreUndefined=s,this.forceIntegerToFloat=c,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}return e.prototype.reinitializeState=function(){this.pos=0},e.prototype.encodeSharedRef=function(e){return this.reinitializeState(),this.doEncode(e,1),this.bytes.subarray(0,this.pos)},e.prototype.encode=function(e){return this.reinitializeState(),this.doEncode(e,1),this.bytes.slice(0,this.pos)},e.prototype.doEncode=function(e,t){if(t>this.maxDepth)throw new Error("Too deep objects in depth ".concat(t));null==e?this.encodeNil():"boolean"==typeof e?this.encodeBoolean(e):"number"==typeof e?this.encodeNumber(e):"string"==typeof e?this.encodeString(e):this.encodeObject(e,t)},e.prototype.ensureBufferSizeToWrite=function(e){var t=this.pos+e;this.view.byteLength<t&&this.resizeBuffer(2*t)},e.prototype.resizeBuffer=function(e){var t=new ArrayBuffer(e),n=new Uint8Array(t),r=new DataView(t);n.set(this.bytes),this.view=r,this.bytes=n},e.prototype.encodeNil=function(){this.writeU8(192)},e.prototype.encodeBoolean=function(e){!1===e?this.writeU8(194):this.writeU8(195)},e.prototype.encodeNumber=function(e){Number.isSafeInteger(e)&&!this.forceIntegerToFloat?e>=0?e<128?this.writeU8(e):e<256?(this.writeU8(204),this.writeU8(e)):e<65536?(this.writeU8(205),this.writeU16(e)):e<4294967296?(this.writeU8(206),this.writeU32(e)):(this.writeU8(207),this.writeU64(e)):e>=-32?this.writeU8(224|e+32):e>=-128?(this.writeU8(208),this.writeI8(e)):e>=-32768?(this.writeU8(209),this.writeI16(e)):e>=-2147483648?(this.writeU8(210),this.writeI32(e)):(this.writeU8(211),this.writeI64(e)):this.forceFloat32?(this.writeU8(202),this.writeF32(e)):(this.writeU8(203),this.writeF64(e))},e.prototype.writeStringHeader=function(e){if(e<32)this.writeU8(160+e);else if(e<256)this.writeU8(217),this.writeU8(e);else if(e<65536)this.writeU8(218),this.writeU16(e);else{if(!(e<4294967296))throw new Error("Too long string: ".concat(e," bytes in UTF-8"));this.writeU8(219),this.writeU32(e)}},e.prototype.encodeString=function(e){if(e.length>D){var t=z(e);this.ensureBufferSizeToWrite(5+t),this.writeStringHeader(t),F(e,this.bytes,this.pos),this.pos+=t}else t=z(e),this.ensureBufferSizeToWrite(5+t),this.writeStringHeader(t),function(e,t,n){for(var r=e.length,o=n,i=0;i<r;){var s=e.charCodeAt(i++);if(0!=(4294967168&s)){if(0==(4294965248&s))t[o++]=s>>6&31|192;else{if(s>=55296&&s<=56319&&i<r){var c=e.charCodeAt(i);56320==(64512&c)&&(++i,s=((1023&s)<<10)+(1023&c)+65536)}0==(4294901760&s)?(t[o++]=s>>12&15|224,t[o++]=s>>6&63|128):(t[o++]=s>>18&7|240,t[o++]=s>>12&63|128,t[o++]=s>>6&63|128)}t[o++]=63&s|128}else t[o++]=s}}(e,this.bytes,this.pos),this.pos+=t},e.prototype.encodeObject=function(e,t){var n=this.extensionCodec.tryToEncode(e,this.context);if(null!=n)this.encodeExtension(n);else if(Array.isArray(e))this.encodeArray(e,t);else if(ArrayBuffer.isView(e))this.encodeBinary(e);else{if("object"!=typeof e)throw new Error("Unrecognized object: ".concat(Object.prototype.toString.apply(e)));this.encodeMap(e,t)}},e.prototype.encodeBinary=function(e){var t=e.byteLength;if(t<256)this.writeU8(196),this.writeU8(t);else if(t<65536)this.writeU8(197),this.writeU16(t);else{if(!(t<4294967296))throw new Error("Too large binary: ".concat(t));this.writeU8(198),this.writeU32(t)}var n=H(e);this.writeU8a(n)},e.prototype.encodeArray=function(e,t){var n=e.length;if(n<16)this.writeU8(144+n);else if(n<65536)this.writeU8(220),this.writeU16(n);else{if(!(n<4294967296))throw new Error("Too large array: ".concat(n));this.writeU8(221),this.writeU32(n)}for(var r=0,o=e;r<o.length;r++){var i=o[r];this.doEncode(i,t+1)}},e.prototype.countWithoutUndefined=function(e,t){for(var n=0,r=0,o=t;r<o.length;r++)void 0!==e[o[r]]&&n++;return n},e.prototype.encodeMap=function(e,t){var n=Object.keys(e);this.sortKeys&&n.sort();var r=this.ignoreUndefined?this.countWithoutUndefined(e,n):n.length;if(r<16)this.writeU8(128+r);else if(r<65536)this.writeU8(222),this.writeU16(r);else{if(!(r<4294967296))throw new Error("Too large map object: ".concat(r));this.writeU8(223),this.writeU32(r)}for(var o=0,i=n;o<i.length;o++){var s=i[o],c=e[s];this.ignoreUndefined&&void 0===c||(this.encodeString(s),this.doEncode(c,t+1))}},e.prototype.encodeExtension=function(e){var t=e.data.length;if(1===t)this.writeU8(212);else if(2===t)this.writeU8(213);else if(4===t)this.writeU8(214);else if(8===t)this.writeU8(215);else if(16===t)this.writeU8(216);else if(t<256)this.writeU8(199),this.writeU8(t);else if(t<65536)this.writeU8(200),this.writeU16(t);else{if(!(t<4294967296))throw new Error("Too large extension object: ".concat(t));this.writeU8(201),this.writeU32(t)}this.writeI8(e.type),this.writeU8a(e.data)},e.prototype.writeU8=function(e){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,e),this.pos++},e.prototype.writeU8a=function(e){var t=e.length;this.ensureBufferSizeToWrite(t),this.bytes.set(e,this.pos),this.pos+=t},e.prototype.writeI8=function(e){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,e),this.pos++},e.prototype.writeU16=function(e){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,e),this.pos+=2},e.prototype.writeI16=function(e){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,e),this.pos+=2},e.prototype.writeU32=function(e){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,e),this.pos+=4},e.prototype.writeI32=function(e){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,e),this.pos+=4},e.prototype.writeF32=function(e){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,e),this.pos+=4},e.prototype.writeF64=function(e){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,e),this.pos+=8},e.prototype.writeU64=function(e){this.ensureBufferSizeToWrite(8),function(e,t,n){var r=n/4294967296,o=n;e.setUint32(t,r),e.setUint32(t+4,o)}(this.view,this.pos,e),this.pos+=8},e.prototype.writeI64=function(e){this.ensureBufferSizeToWrite(8),A(this.view,this.pos,e),this.pos+=8},e}();function ue(e){return ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ue(e)}function fe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==ue(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==ue(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===ue(o)?o:String(o)),r)}var o}function he(){return he="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=pe(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},he.apply(this,arguments)}function le(e,t){return le=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},le(e,t)}function pe(e){return pe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},pe(e)}function de(){de=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function a(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{a({},"")}catch(e){a=function(e,t,n){return e[t]=n}}function u(e,t,n,o){var i=t&&t.prototype instanceof l?t:l,s=Object.create(i.prototype),c=new L(o||[]);return r(s,"_invoke",{value:U(e,n,c)}),s}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var h={};function l(){}function p(){}function d(){}var y={};a(y,i,(function(){return this}));var v=Object.getPrototypeOf,w=v&&v(v(j([])));w&&w!==t&&n.call(w,i)&&(y=w);var g=d.prototype=l.prototype=Object.create(y);function b(e){["next","throw","return"].forEach((function(t){a(e,t,(function(e){return this._invoke(t,e)}))}))}function m(e,t){function o(r,i,s,c){var a=f(e[r],e,i);if("throw"!==a.type){var u=a.arg,h=u.value;return h&&"object"==ue(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){o("next",e,s,c)}),(function(e){o("throw",e,s,c)})):t.resolve(h).then((function(e){u.value=e,s(u)}),(function(e){return o("throw",e,s,c)}))}c(a.arg)}var i;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){o(e,n,t,r)}))}return i=i?i.then(r,r):r()}})}function U(e,t,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var s=n.delegate;if(s){var c=x(s,n);if(c){if(c===h)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var a=f(e,t,n);if("normal"===a.type){if(r=n.done?"completed":"suspendedYield",a.arg===h)continue;return{value:a.arg,done:n.done}}"throw"===a.type&&(r="completed",n.method="throw",n.arg=a.arg)}}}function x(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,x(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var o=f(r,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,h;var i=o.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,h):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function L(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function j(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:O}}function O(){return{value:void 0,done:!0}}return p.prototype=d,r(g,"constructor",{value:d,configurable:!0}),r(d,"constructor",{value:p,configurable:!0}),p.displayName=a(d,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,a(e,c,"GeneratorFunction")),e.prototype=Object.create(g),e},e.awrap=function(e){return{__await:e}},b(m.prototype),a(m.prototype,s,(function(){return this})),e.AsyncIterator=m,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var s=new m(u(t,n,r,o),i);return e.isGeneratorFunction(n)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},b(g),a(g,c,"Generator"),a(g,i,(function(){return this})),a(g,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=j,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(E),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return s.type="throw",s.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],s=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),a=n.call(i,"finallyLoc");if(c&&a){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!a)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var s=i?i.completion:{};return s.type=e,s.arg=t,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),E(n),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;E(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:j(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}},e}function ye(e,t,n,r,o,i,s){try{var c=e[i](s),a=c.value}catch(e){return void n(e)}c.done?t(a):Promise.resolve(a).then(r,o)}function ve(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return we(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?we(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){c=!0,i=e},f:function(){try{s||null==n.return||n.return()}finally{if(c)throw i}}}}function we(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ge(){var e={};return e.promise=new Promise((function(t,n){e.resolve=t,e.reject=n})),e}var be={secret:"wslink-secret",ws:null};function me(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,be,n),r.destroy(e,t),r.isA(e,t,"Session"),function(e,t){var n=-32099,r=0,o={},i=/^(rpc|publish|system):(\w+(?:\.\w+)*):(?:\d+)$/,s={},c=null,a=524288,u=new x;function f(e){if(e&&e.id){if(e.error){var t=o[e.id];t?t.reject(e.error):console.error("Server error:",e.error)}else{var r=i.exec(e.id);if(r){var u=r[1];if("rpc"===u){var f=o[e.id];if(!f)return void console.log("session message id without matching call, dropped",e);f.resolve(e.result)}else if("publish"==u){console.assert(void 0===o[e.id],"publish message received matching in-flight rpc call");var h=r[2];if(!s[h])return;s[h].forEach((function(t){return t([e.result])}))}else if("system"==u){var l=o[e.id];"system:c0:0"===e.id?(c=e.result.clientID,a=e.result.maxMsgSize||a,l&&l.resolve(c)):(console.error("Unknown system message",e.id),l&&l.reject({code:n,message:"Unknown system message ".concat(e.id)}))}else console.error("Unknown rpc id format",e.id)}}delete o[e.id]}}function h(){return new ie}e.onconnect=function(e){var n=ge(),r="system:c0:0";o[r]=n;var i,s={wslink:"1.0",id:r,method:"wslink.hello",args:[{secret:t.secret}],kwargs:{}},c=ve(U((new xe).encode(s),a));try{for(c.s();!(i=c.n()).done;){var u=i.value;t.ws.send(u,{binary:!0})}}catch(e){c.e(e)}finally{c.f()}return n.promise},e.call=function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},u=ge();if(t.ws&&c&&1===t.ws.readyState){var f="rpc:".concat(c,":").concat(r++);o[f]=u;var h,l={wslink:"1.0",id:f,method:e,args:i,kwargs:s},p=ve(U((new xe).encode(l),a));try{for(p.s();!(h=p.n()).done;){var d=h.value;t.ws.send(d,{binary:!0})}}catch(e){p.e(e)}finally{p.f()}}else u.reject({code:n,message:"RPC call ".concat(e," unsuccessful: connection not open")});return u.promise},e.subscribe=function(r,o){var i=ge();return t.ws&&c?(s[r]||(s[r]=[]),s[r].push(o),i.resolve({topic:r,callback:o})):i.reject({code:n,message:"Subscribe call ".concat(r," unsuccessful: connection not open")}),{topic:r,callback:o,promise:i.promise,unsubscribe:function(){return e.unsubscribe({topic:r,callback:o})}}},e.unsubscribe=function(e){var t=ge(),r=e.topic,o=e.callback;if(!s[r])return t.reject({code:n,message:"Unsubscribe call ".concat(r," unsuccessful: not subscribed")}),t.promise;var i=s[r].indexOf(o);return-1!==i?(s[r].splice(i,1),t.resolve()):t.reject({code:n,message:"Unsubscribe call ".concat(r," unsuccessful: callback not found")}),t.promise},e.close=function(){var e=ge();return t.ws.close(),u.releasePendingMessages(),e.resolve(),e.promise},e.onmessage=function(){var e,t=(e=de().mark((function e(t){var n;return de().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.processChunk(t.data,h);case 2:(n=e.sent)&&f(n);case 4:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function s(e){ye(i,r,o,s,c,"next",e)}function c(e){ye(i,r,o,s,c,"throw",e)}s(void 0)}))});return function(e){return t.apply(this,arguments)}}(),e.addAttachment=function(e){return e instanceof ArrayBuffer?new DataView(e):e}}(e,t)}const Ue={newInstance:r.newInstance(me),extend:me};var xe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&le(e,t)}(s,e);var t,n,r,o,i=(r=s,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=pe(r);if(o){var n=pe(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===ue(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function s(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),i.apply(this,arguments)}return t=s,(n=[{key:"encodeObject",value:function(e,t){return e instanceof ArrayBuffer&&(e=new DataView(e)),he(pe(s.prototype),"encodeObject",this).call(this,e,t)}}])&&fe(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),s}(ae),Se="wslink-secret";function Ee(e){var t=e.indexOf(":"),n=e.substring(0,t);if("ws"===n||"wss"===n)return{type:"websocket",url:e};throw new Error("Unknown protocol (".concat(n,") for url (").concat(e,").  Unable to create transport object."))}var Le={secret:Se,connection:null,session:null,retry:!1,wsProxy:!1};function je(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,Le,n),r.destroy(e,t),r.event(e,t,"ConnectionReady"),r.event(e,t,"ConnectionClose"),r.event(e,t,"ConnectionError"),r.isA(e,t,"WebsocketConnection"),function(e,t){e.connect=function(){if(!t.urls)return null;for(var n=[].concat(t.urls),r=[],o=0;o<n.length;o+=1){var i=n[o];try{var s=Ee(i);r.push(s)}catch(t){return console.error(t),e.fireConnectionError(e,t),null}}if(t.connection)if(t.connection.url!==r[0].url)t.connection.close();else if(0===t.connection.readyState||1===t.connection.readyState)return t.session;try{t.wsProxy?t.connection=WSLINK.createWebSocket(r[0].url):t.connection=new WebSocket(r[0].url)}catch(t){return console.error(t),e.fireConnectionError(e,t),null}return t.connection.binaryType="blob",t.secret||(t.secret=Se),t.session=Ue.newInstance({ws:t.connection,secret:t.secret}),t.connection.onopen=function(n){t.session&&t.session.onconnect(n).then((function(){e.fireConnectionReady(e)}),(function(t){console.error("Connection error",t),e.fireConnectionError(e,t)}))},t.connection.onclose=function(n){e.fireConnectionClose(e,n),t.connection=null},t.connection.onerror=function(t){e.fireConnectionError(e,t)},t.connection.onmessage=function(e){t.session.onmessage(e)},t.session},e.getSession=function(){return t.session},e.getUrl=function(){return t.connection?t.connection.url:void 0},e.destroy=r.chain((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;t.connection&&1===t.connection.readyState&&t.session&&e>0&&t.session.call("application.exit.later",[e]),t.connection&&t.connection.close(),t.connection=null}),e.destroy)}(e,t)}const Oe={newInstance:r.newInstance(je),extend:je};function ke(e){return e.sessionURL&&(e.sessionURL=e.sessionURL.replaceAll("USE_HOSTNAME",window.location.hostname),e.sessionURL=e.sessionURL.replaceAll("USE_HOST",window.location.host)),e}var Ae="".concat(document.baseURI,"paraview/"),Pe="".concat("https:"===window.location.protocol?"wss:":"ws:","//").concat(window.location.hostname,":").concat(window.location.port).concat(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.location.pathname;if(t.endsWith(".html")||t.endsWith(".htm")){var n=t.split("/");n.pop(),t=n.join("/")}for(;t.length>0&&"/"===t[t.length-1];)t=t.substring(0,t.length-1);return 0===t.length?e:"".concat(t).concat(e)}("/ws"));function Ie(e,t){var n=Oe.newInstance({urls:t.config.sessionURL,secret:t.config.secret,retry:t.config.retry,wsProxy:t.config.iframe||t.config.wsProxy});return t.subscriptions.push(n.onConnectionReady(e.readyForwarder)),t.subscriptions.push(n.onConnectionError(e.errorForwarder)),t.subscriptions.push(n.onConnectionClose(e.closeForwarder)),t.gc.push(n),n.connect()}var Te={config:{}};function Be(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,Te,n),r.destroy(e,t),r.event(e,t,"ConnectionReady"),r.event(e,t,"ConnectionClose"),r.event(e,t,"ConnectionError"),r.isA(e,t,"SmartConnect"),r.get(e,t,["config","configDecorator"]),r.set(e,t,["configDecorator"]),function(e,t){var n=null;t.gc=[],e.readyForwarder=function(t){n=t.getSession(),e.fireConnectionReady(t)},e.errorForwarder=function(t,n){e.fireConnectionError(t,n)},e.closeForwarder=function(t,n){e.fireConnectionClose(t,n)},e.connect=function(){if(t.configDecorator&&(t.config=t.configDecorator(t.config)),t.config=ke(t.config),t.config.sessionURL)n=Ie(e,t);else if(t.config.wsProxy)t.config.sessionURL=t.config.sessionURL||"wss://proxy/",n=Ie(e,t);else{var r=a.newInstance({endPoint:t.config.sessionManagerURL||Ae});t.subscriptions.push(r.onProcessReady((function(r){t.configDecorator?t.config=t.configDecorator(Object.assign({},t.config,r)):t.config=Object.assign({},t.config,r),t.config=ke(t.config),n=Ie(e,t)}))),t.subscriptions.push(r.onError((function(r){r&&r.response&&r.response.error?e.errorForwarder(r,r.response.error):(t.config.sessionURL=Pe,t.config=ke(t.config),n=Ie(e,t))}))),r.start(t.config),t.gc.push(r)}},e.getSession=function(){return n},e.destroy=r.chain((function(e){for(n&&(e>0&&n.call("application.exit.later",[e]),n.close()),n=null;t.gc.length;)t.gc.pop().destroy()}),e.destroy)}(e,t)}const _e={newInstance:r.newInstance(Be),extend:Be};return t})()));
//# sourceMappingURL=wslink.js.map